## Version 1.4.1
## language: en

Feature:
  TOE:
    basic pentesting
  Category:
    No category
  Location:
    192.168.0.25:80
  CWE:
    CWE-521: Weak Password Requirements
  Rule:
    REQ.142 Change system default credentials
  Goal:
    Accessing the website as an administrator
  Recommendation:
    Place more secure authentication credentials

  Background:
  Hacker's software:
    | <Software name> | <Version>   |
    | Kali Linux      | 2020.1      |
    | Firefox Quantum | 68.20esr    |
    | Nmap            | 7.80        |
    | Gobuster        | 3.0.1       |
  TOE information:
    Given I'm accessing the server 192.168.0.25
    And HTTP is open on port 80
    And is running on Ubuntu 2.6.24

  Scenario: Normal use case
  The server has an access to a web page
    Given I'm scanning the server
    """
    $ nmap -p- -sV 192.168.0.31 --open
    """
    When I can see which ports are open
    """
    PORT   STATE SERVICE VERSION
    21/tcp open  ftp     ProFTPD 1.3.3c
    22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.2
    80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))
    """
    Then I decide to enter port 80 to see the website

  Scenario: Static detection
  No code given

  Scenario: Dynamic detection
  Website with wordpress
    Given I found a port 80
    When I decide to go in
    """
    http://192.168.0.25:80
    """
    Then I see that it's a very simple website
    And I decide to inspect the code with firefox's "Inspect Element"
    When I see that the code has nothing interesting for me
    Then I decide to scan the IP to see if it has any "end points"
    """
    $ gobuster dir -u http://192.168.0.25/
      -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
      -x php,txt,html
    """
    And it generates an interesting result
    """
    /index.html (Status: 200)
    /secret (Status: 301)
    """

  Scenario: Exploitation
  Access to wordpress as an administrator user
    Given I found an path with the name "/secret"
    When I decide to go on that route like this
    """
    http://192.168.0.25/secret
    """
    Then I see it's a page without any "CSS"
    And I'm going in to check the code to see if there's anything interesting
    When I realize that there are several URLs that use this "Host"
    """
    vtcsec/
    """
    Then I decide to add that "Host" to the "IP" of the victim server
    And to do that I have to put it in my "Host" file like this
    """
    $ vim /etc/hosts
    """
    When I decide to go to the page again but with the "Host" that I found
    """
    http://vtcsec/secret
    """
    Then I realize that the page has been changed with a better "CSS"
    And it has a login link that's from "Wordpress"
    When I decide to log in with these credentials
    """
    username: admin
    paswword: admin
    """
    And I have access to the Wordpress panel as an administrator

  Scenario: Remediation
  No code given

  Scenario: Scoring
  Severity scoring according to CVSSv3 standard
  Base: Attributes that are constants over time and organizations
    4.4/10 (medium) - AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:L
  Temporal: Attributes that measure the exploit's popularity and fixability
    4.2/10 (medium) - E:X/RL:O/RC:X
  Environmental: Unique and relevant attributes to a specific user environment
    4.4/10 (medium) - MAV:A/MAC:L/MPR:L/MUI:N/MS:U/MC:N/MI:L/MA:L
